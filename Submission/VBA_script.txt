Sub formatallsheets():
    
    ' to run code across all worksheets - got this from Xpert Learning Assistant
    Dim ws As Worksheet
    
    For Each ws In ThisWorkbook.Sheets
    
        ' i is row number
        Dim i As Long
        ' vol is volume column
        Dim vol As LongLong
        ' vol_total is the total volume per stock symbol
        Dim vol_total As LongLong
        ' ticker is the stock symbols in column 1
        Dim ticker As String
        ' percent_change is change between open and close
        Dim percent_change As Double
        
        ' leaderboard row
        Dim k As Long
        
        ' close price
        Dim close_price As Double
        ' open price
        Dim open_price As Double
        ' change between initial open price and last close price
        Dim price_change As Double
        ' last row per symbol
        Dim last_row As Long
        
        
        ' got this code from Professor
        last_row = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row
        
        vol_total = 0
        k = 2
        
        ' columns
        ws.Range("I1").Value = "Ticker"
        ws.Range("J1").Value = "Quarterly Change"
        ws.Range("K1").Value = "Percent Change"
        ws.Range("L1").Value = "Volume"
        
        open_price = ws.Cells(2, 3).Value
        
        
        For i = 2 To last_row
            vol = ws.Cells(i, 7).Value
            ticker = ws.Cells(i, 1).Value
            
            ' finding a different ticker value
            If (ws.Cells(i + 1, 1).Value <> ticker) Then
                vol_total = vol_total + vol
            
                close_price = ws.Cells(i, 6).Value
                price_change = close_price - open_price
                
                ' trying to not get an error
                If (open_price > 0) Then
                    percent_change = price_change / open_price
                Else
                    percent_change = 0
                End If
                 
                ' placing the values in the right columns
                ws.Cells(k, 9).Value = ticker
                ws.Cells(k, 10).Value = price_change
                ws.Cells(k, 12).Value = vol_total
                ws.Cells(k, 11).Value = percent_change
                
                ' changing the color based on the values
                If (price_change > 0) Then
                    ws.Cells(k, 10).Interior.ColorIndex = 4
                ElseIf (price_change < 0) Then
                    ws.Cells(k, 10).Interior.ColorIndex = 3
                Else
                    ws.Cells(k, 10).Interior.ColorIndex = 2
                End If
                
                ' reset everything
                vol_total = 0
                k = k + 1
                ticker_open = ws.Cells(i + 1, 3).Value
            Else
                vol_total = vol_total + vol
            End If
        Next i
        
        ws.Columns("K:K").NumberFormat = "0.00%"
        ws.Columns("I:L").AutoFit
        
        
        ' trying to create the max and min percentages from leaderboard - got parts from xpert learning assistant
        Dim rng As Range
        Dim cell As Range
        Dim max_value As Double
        Dim min_value As Double
        Dim rng_2 As Range
        Dim rng_3 As Range
        Dim rng_4 As Range
        
        Set rng = ws.Range("K2:K1000")
        Set rng_2 = ws.Range("L2:L1000")
        Set rng_3 = ws.Range("J2:J1000")
        Set rng_4 = ws.Range("I2:I1000")
        
        max_value = -999999
        min_value = 999999
        max_volume = 0
        
        For Each cell In rng
            If IsNumeric(cell.Value) Then
                If cell.Value > max_value Then
                    max_value = cell.Value
                End If
                If cell.Value < min_value Then
                    min_value = cell.Value
                End If
            End If
        Next cell
        
        For Each cell In rng_2
            If IsNumeric(cell.Value) Then
                If cell.Value > max_volume Then
                    max_volume = cell.Value
                End If
            End If
        Next cell
        
        ws.Cells(1, 16).Value = "Ticker"
        ws.Cells(1, 17).Value = "Value"
        ws.Cells(2, 15).Value = "Greatest % Increase"
        ws.Cells(3, 15).Value = "Greatest % Decrease"
        ws.Cells(4, 15).Value = "Greatest Total Volume"
        ws.Cells(2, 17).Value = max_value
        ws.Cells(3, 17).Value = min_value
        ws.Cells(4, 17).Value = max_volume
        
        
        ws.Columns("O:Q").AutoFit
        ws.Range("Q2:Q3").NumberFormat = "0.00%"
        
        
    Next ws
End Sub

Sub reset()
 Dim ws As Worksheet
    
    For Each ws In ThisWorkbook.Sheets
        ' got this from xpert learning assistant
        ws.Columns("I:L").Interior.ColorIndex = x1none
        ws.Columns("i:L").Value = ""
    Next ws
    
End Sub
